function updateGraph() {
    fetch(`${BASE_URL}/history`)
        .then(response => response.json())
        .then(history => {
            if (history.length > 0) {
                const latestData = history[history.length - 1];
                const { time, altitude } = latestData;
                
                // Append only if new data is received
                if (!times.includes(time)) {
                    times.push(time);
                    altitudes.push(altitude);

                    altitudeChart.data.labels = times;
                    altitudeChart.data.datasets[0].data = altitudes;
                    altitudeChart.update();
                }
            } else {
                console.log('No history data available');
            }
        })
        .catch(error => console.error('Error updating graph:', error));
}

function updateMapAndPath() {
    fetch(`${BASE_URL}/live-data`)
        .then(response => response.json())
        .then(data => {
            if (data.latitude && data.longitude) {
                const { latitude, longitude, altitude, temperature } = data;

                // Update marker location on the map
                marker.setLatLng([latitude, longitude]);
                marker.bindPopup(
                    `Satellite Location<br>Lat: ${latitude.toFixed(4)}, Long: ${longitude.toFixed(4)}<br>Alt: ${altitude}m<br>Temp: ${temperature}Â°C`
                ).openPopup();

                // Update flight path
                flightPath.push([latitude, longitude]);
                pathLine.setLatLngs(flightPath);

                // Adjust map bounds to fit updated path
                map.fitBounds(pathLine.getBounds());
            }
        })
        .catch(error => console.error('Error updating map and path:', error));
}

